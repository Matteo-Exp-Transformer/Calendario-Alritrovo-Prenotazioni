# Template Test UI Responsive - Calendario Al Ritrovo

## Obiettivo
Verificare, dopo ogni fix UI, che:
1. Il problema originale sia risolto
2. La UI resti responsive secondo [Responsive-design-skills.md](./Responsive-design-skills.md)
3. Non vengano introdotte regressioni evidenti su altri componenti

---

## PARTE 1: Input per l'Agente Tester

### Input Obbligatori
Prima di eseguire il test, l'agente deve avere:

1. **Descrizione Fix**
   - Qual è il problema risolto?
   - Quali file sono stati modificati?
   - Esempio: "Fix scroll orizzontale su card menu - modificato MenuSelection.tsx"

2. **Componenti/Schermate Coinvolti**
   - Lista componenti modificati con path
   - Pagine da testare
   - Esempio:
     - `src/features/booking/components/MenuSelection.tsx`
     - Pagina: `/prenota` (BookingRequestPage)

3. **Ambiente Test**
   - URL: `http://localhost:5175`
   - Branch git (se applicabile)
   - Build version (se applicabile)

4. **Stati Specifici da Testare**
   - Form con dati popolati / vuoti
   - Liste piene / vuote
   - Modali aperti / chiusi
   - Stati di errore
   - Menu con tutti gli item visibili
   - Esempio: "Selezionare 'Rinfresco di Laurea' per vedere il menu completo"

5. **Viewport da Testare** (default o custom)
   - Se non specificato, usare viewport standard (vedi sotto)

---

## PARTE 2: Esecuzione Test

### Viewport di Riferimento

#### Mobile (OBBLIGATORIO - testare sempre questi)
```typescript
const mobileViewports = [
  { width: 360, height: 640, name: 'Smartphone piccolo (Galaxy S5)' },
  { width: 360, height: 800, name: 'Smartphone medio (Pixel 2)' },
  { width: 390, height: 844, name: 'Smartphone moderno (iPhone 12/13)' }
]
```

#### Tablet (se rilevante per la feature)
```typescript
const tabletViewport = { width: 768, height: 1024, name: 'iPad portrait' }
```

#### Desktop (se rilevante)
```typescript
const desktopViewport = { width: 1280, height: 800, name: 'Desktop standard' }
```

**Default**: Testare sempre portrait. Testare landscape SOLO se richiesto o per feature specifiche (es. calendar, gallerie immagini).

---

### Checklist Test per Viewport

Per ogni **schermata** e **viewport**, verificare:

#### ✅ 1. Layout Integro
- [ ] **Nessuno scroll orizzontale**
  ```typescript
  const hasHorizontalScroll = await page.evaluate(() => {
    return document.documentElement.scrollWidth > document.documentElement.clientWidth
  })
  expect(hasHorizontalScroll).toBe(false)
  ```
- [ ] **Nessun elemento fuori viewport**
  - Verificare bounding box card/container
  - `cardBox.x + cardBox.width <= viewport.width`
- [ ] **Nessuna sovrapposizione** tra elementi

#### ✅ 2. Testo Leggibile
- [ ] **Font size minimo rispettato**
  - Body text >= 12px
  - Titoli >= 14px
  - Bottoni/Input >= 16px
  ```typescript
  const fontSize = await element.evaluate((el) => {
    return parseFloat(window.getComputedStyle(el).fontSize)
  })
  expect(fontSize).toBeGreaterThanOrEqual(12)
  ```
- [ ] **Nessun testo tagliato**
  - Verificare wrapping corretto
  - Verificare overflow-wrap / word-break
- [ ] **Contrasto sufficiente** (se modificato styling)

#### ✅ 3. Elementi Interattivi Usabili
- [ ] **Bottoni cliccabili**
  - Dimensione minima 44×44px
  - Spacing tra bottoni >= 8px
- [ ] **Checkbox/Radio utilizzabili**
  - Area cliccabile sufficiente
- [ ] **Link distinguibili** e cliccabili
- [ ] **Form input accessibili**
  - Label visibili
  - Input sufficientemente grandi

#### ✅ 4. Componenti Complessi Funzionanti
- [ ] **Menu/Dropdown** - Si aprono correttamente, non escono dal viewport
- [ ] **Modali** - Full screen su mobile, centrati su desktop
- [ ] **Tabelle** - Scrollabili o riorganizzate in card
- [ ] **Calendar** - Responsive, usabile con touch
- [ ] **Card con contenuti dinamici** - Adattano altezza/larghezza

#### ✅ 5. Regressioni Visive
- [ ] **Componenti non modificati** funzionano ancora
- [ ] **Spacing consistente** con resto dell'app
- [ ] **Colori e stili coerenti** con design system

#### ✅ 6. Cambio Orientamento (se testato)
- [ ] **Portrait → Landscape** - Layout non si rompe
- [ ] **Landscape → Portrait** - Layout non si rompe

---

### Screenshot Obbligatori

Per ogni viewport testato, salvare:

1. **Screenshot schermata completa**
   ```typescript
   await page.screenshot({
     path: `e2e/screenshots/test-name-${viewport.width}x${viewport.height}.png`,
     fullPage: false // Solo viewport visibile
   })
   ```

2. **Screenshot componente specifico** (se fix mirato)
   ```typescript
   const component = page.locator('.component-selector')
   await component.screenshot({
     path: `e2e/screenshots/component-name-${viewport.width}x${viewport.height}.png`
   })
   ```

---

## PARTE 3: Output Report

### Struttura Report (markdown)

```markdown
# Test Responsive: [Nome Feature/Fix]

## Riepilogo Esecuzione
**Data**: YYYY-MM-DD
**Test File**: `e2e/path/to/test.spec.ts`
**Branch**: [branch name]
**Build**: [build version se disponibile]
**Tempo Totale**: Xm Ys

---

## Fix Testato
**Descrizione**: [Descrizione del fix applicato]
**File Modificati**:
- `path/to/file1.tsx`
- `path/to/file2.tsx`

**Componenti Coinvolti**: [Lista componenti]
**Pagine Testate**: [Lista pagine con URL]

---

## Statistiche Test

| Stato | Quantità | Percentuale |
|-------|----------|------------|
| **Totali** | X | 100% |
| **Passed** | Y | Z% |
| **Failed** | W | K% |
| **Flaky** | 0 | 0% |
| **Skipped** | 0 | 0% |

---

## Tabella Risultati Dettagliata

| Schermata | Viewport | Test | Esito | Note |
|-----------|----------|------|-------|------|
| [Pagina] | 360×640 | Layout integro | ✅ OK | - |
| [Pagina] | 360×640 | Testo leggibile | ✅ OK | - |
| [Pagina] | 360×640 | Elementi usabili | ✅ OK | - |
| [Pagina] | 360×640 | Screenshot | ✅ OK | - |
| [Pagina] | 360×800 | Layout integro | ✅ OK | - |
| ... | ... | ... | ... | ... |

---

## Problemi Rilevati

### [Se TUTTI OK]
✅ **Nessun problema rilevato** - Tutti i test sono passati con successo.

### [Se CI SONO PROBLEMI - per ogni problema]

#### ❌ Problema #1: [Titolo breve]
**Posizione**: [Pagina] - [Componente] - Viewport [width]×[height]
**Descrizione**: [Descrizione chiara del problema]
**Riproduzione**:
1. Step 1
2. Step 2
3. Expected: X, Actual: Y

**Screenshot**: `e2e/screenshots/problema-1.png`
**Priorità**: [Alta/Media/Bassa]

---

## Criteri Responsive-Design Verificati

Secondo [Responsive-design-skills.md](./Responsive-design-skills.md):

1. ✅/❌ **Criterio #1**: Adattamento ai viewport
2. ✅/❌ **Criterio #2**: Nessuno scroll orizzontale indesiderato
3. ✅/❌ **Criterio #3**: Layout che si ricompone
4. ✅/❌ **Criterio #4**: Testo sempre leggibile
5. ✅/❌ **Criterio #5**: Click/touch utilizzabili
6. ✅/❌ **Criterio #6**: Immagini e icone fluide
7. ✅/❌ **Criterio #7**: Componenti complessi gestiti bene
8. ✅/❌ **Criterio #8**: Cambio orientamento stabile
9. ✅/❌ **Criterio #9**: Coerenza visiva

---

## Verdetto Finale

### ✅ **APPROVATO** [se tutti test OK]
Tutti i test responsive sono passati con successo. Il fix è efficace e non introduce regressioni.

**Prossimi passi**:
- ✅ Merge del fix
- ⏳ Deploy in staging per test su dispositivi reali (opzionale)

### ❌ **DA RIVEDERE** [se almeno un test KO]
Sono stati rilevati [N] problemi che richiedono attenzione prima dell'approvazione.

**Azioni richieste**:
1. Fix problema #1: [descrizione breve]
2. Fix problema #2: [descrizione breve]
3. Rieseguire test dopo fix

---

## Note Tecniche [Opzionale]

- Eventuali note su performance
- Problemi marginali non bloccanti
- Suggerimenti per miglioramenti futuri

---

## Riferimenti

- **Test File**: `e2e/path/to/test.spec.ts`
- **Screenshots**: `e2e/screenshots/`
- **Skill Responsive Design**: `.claude/skills/Responsive-Design/Responsive-design-skills.md`
- **Report precedenti**: `docs/reports/` (se applicabile)

```

---

## PARTE 4: Esempio Test File Playwright

### Template Completo

```typescript
import { test, expect } from '@playwright/test'

/**
 * Test Responsive: [Nome Feature/Fix]
 *
 * Descrizione: [Cosa testa questo file]
 *
 * Fix verificato: [Descrizione fix]
 *
 * Basato su: Responsive-Design Skills
 * Template: Template-test-responsive
 */

test.describe('[Nome Feature] - Responsive Test', () => {

  // Viewport di riferimento
  const viewports = [
    { width: 360, height: 640, name: 'Smartphone piccolo' },
    { width: 360, height: 800, name: 'Smartphone medio/alto' },
    { width: 390, height: 844, name: 'Smartphone moderno' }
  ]

  // Setup comune
  test.beforeEach(async ({ page }) => {
    await page.goto('/pagina-da-testare')
    await page.waitForLoadState('networkidle')

    // Setup stato specifico se necessario
    // Esempio: selezionare tipo booking
    const selectElement = page.locator('#select-id')
    if (await selectElement.count() > 0) {
      await selectElement.selectOption('valore')
      await page.waitForTimeout(1500) // Attendere caricamento
    }
  })

  // Test per ogni viewport
  for (const viewport of viewports) {

    test(`Viewport ${viewport.name} (${viewport.width}×${viewport.height}): Verifica layout integro`, async ({ page }) => {
      await page.setViewportSize({ width: viewport.width, height: viewport.height })

      // Scroll al componente da testare
      const component = page.locator('h2:has-text("Titolo Sezione")')
      await component.scrollIntoViewIfNeeded()
      await page.waitForTimeout(500)

      // 1. Verifica nessuno scroll orizzontale
      const hasHorizontalScroll = await page.evaluate(() => {
        return document.documentElement.scrollWidth > document.documentElement.clientWidth
      })
      expect(hasHorizontalScroll).toBe(false)

      // 2. Verifica elementi visibili
      const categories = ['Categoria1', 'Categoria2']
      for (const category of categories) {
        const categoryHeader = page.locator(`h3:has-text("${category}")`).first()
        if (await categoryHeader.count() > 0) {
          await expect(categoryHeader).toBeVisible()
        }
      }

      // 3. Verifica elementi non escono dal viewport
      const cards = page.locator('.card-selector')
      const cardCount = await cards.count()

      for (let i = 0; i < Math.min(cardCount, 5); i++) {
        const card = cards.nth(i)
        const cardBox = await card.boundingBox()

        if (cardBox) {
          expect(cardBox.x).toBeGreaterThanOrEqual(0)
          expect(cardBox.x + cardBox.width).toBeLessThanOrEqual(viewport.width + 1)
        }
      }
    })

    test(`Viewport ${viewport.name}: Verifica testo leggibile`, async ({ page }) => {
      await page.setViewportSize({ width: viewport.width, height: viewport.height })

      // Trova elementi con testo
      const textElements = page.locator('.text-selector')
      const count = await textElements.count()

      for (let i = 0; i < Math.min(count, 10); i++) {
        const element = textElements.nth(i)

        // Verifica font size minimo
        const fontSize = await element.evaluate((el) => {
          return parseFloat(window.getComputedStyle(el).fontSize)
        })
        expect(fontSize).toBeGreaterThanOrEqual(12)

        // Verifica wrapping configurato
        const cssProps = await element.evaluate((el) => {
          const style = window.getComputedStyle(el)
          return {
            wordBreak: style.wordBreak,
            overflowWrap: style.overflowWrap
          }
        })

        expect(
          cssProps.wordBreak === 'break-word' ||
          cssProps.overflowWrap === 'break-word'
        ).toBe(true)
      }
    })

    test(`Viewport ${viewport.name}: Verifica elementi interattivi`, async ({ page }) => {
      await page.setViewportSize({ width: viewport.width, height: viewport.height })

      // Verifica bottoni cliccabili
      const buttons = page.locator('button')
      const buttonCount = await buttons.count()

      for (let i = 0; i < Math.min(buttonCount, 5); i++) {
        const button = buttons.nth(i)
        const buttonBox = await button.boundingBox()

        if (buttonBox) {
          // Dimensione minima 44×44px
          expect(buttonBox.width).toBeGreaterThanOrEqual(44)
          expect(buttonBox.height).toBeGreaterThanOrEqual(44)
        }
      }
    })

    test(`Viewport ${viewport.name}: Screenshot verifica visiva`, async ({ page }) => {
      await page.setViewportSize({ width: viewport.width, height: viewport.height })

      // Screenshot completo
      await page.screenshot({
        path: `e2e/screenshots/test-name-${viewport.width}x${viewport.height}.png`,
        fullPage: false
      })

      // Screenshot componente specifico
      const component = page.locator('.component-selector').first()
      if (await component.count() > 0) {
        await component.screenshot({
          path: `e2e/screenshots/component-${viewport.width}x${viewport.height}.png`
        })
      }
    })
  }

  // Test cambio orientamento
  test('Cambio orientamento: layout resta coerente', async ({ page }) => {
    // Portrait
    await page.setViewportSize({ width: 390, height: 844 })
    await page.goto('/pagina-da-testare')
    await page.waitForLoadState('networkidle')

    const portraitScroll = await page.evaluate(() => {
      return document.documentElement.scrollWidth > document.documentElement.clientWidth
    })
    expect(portraitScroll).toBe(false)

    // Landscape
    await page.setViewportSize({ width: 844, height: 390 })
    await page.waitForTimeout(500)

    const landscapeScroll = await page.evaluate(() => {
      return document.documentElement.scrollWidth > document.documentElement.clientWidth
    })
    expect(landscapeScroll).toBe(false)
  })
})
```

---

## PARTE 5: Comandi Esecuzione

### Eseguire il Test

```bash
# Singolo test file
npx playwright test e2e/responsive/test-name.spec.ts

# Tutti i test responsive
npx playwright test e2e/responsive/

# Con UI mode (debug)
npx playwright test e2e/responsive/test-name.spec.ts --ui

# Con debug
npx playwright test e2e/responsive/test-name.spec.ts --debug

# Solo un viewport specifico (filtrare per nome test)
npx playwright test e2e/responsive/test-name.spec.ts -g "360×640"
```

### Generare Report

```bash
# Eseguire test e generare HTML report
npx playwright test e2e/responsive/ --reporter=html

# Aprire report
npx playwright show-report
```

---

## PARTE 6: Checklist Finale per Agente

Prima di concludere il test, verificare:

- [ ] Tutti i viewport obbligatori sono stati testati
- [ ] Screenshot generati per ogni viewport
- [ ] Report markdown creato con tutte le sezioni
- [ ] Tabella risultati completa
- [ ] Verdetto chiaro (APPROVATO / DA RIVEDERE)
- [ ] Se problemi, descrizione chiara per ogni problema
- [ ] Riferimenti ai file di test e screenshot
- [ ] Criteri Responsive-Design verificati (9 punti)

**Se tutto OK**: Report completo e pronto per revisione ✅

---

## Riferimenti

- **Skill Responsive Design**: [Responsive-design-skills.md](./Responsive-design-skills.md)
- **Test Esempio Reale**: `e2e/responsive/test-menu-cards-text-wrapping.spec.ts`
- **Report Esempio**: `docs/reports/RESPONSIVE_TEST_RESULTS_AFTER_FIX.md`
- **Analisi Esempio**: `docs/reports/RESPONSIVE_TEST_MENU_CARDS_ANALYSIS.md`
- **Playwright Docs**: https://playwright.dev/

---

**Questo template è stato creato basandosi su test reali eseguiti nel progetto Calendario Al Ritrovo.**
